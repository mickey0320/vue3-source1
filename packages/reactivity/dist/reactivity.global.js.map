{
  "version": 3,
  "sources": ["../src/index.ts", "../../shared/src/index.ts", "../src/baseHandler.ts", "../src/effect.ts", "../src/reactive.ts"],
  "sourcesContent": ["import { reactive } from \"./reactive\";\nimport { effect } from \"./effect\";\n\nexport { reactive, effect };\n", "export function isObject(val) {\n  return typeof val === \"object\" && val !== null;\n}\n", "import { activeEffect } from \"./effect\";\nimport { ReactiveFlags, track, trigger } from \"./reactive\";\n\nconst baseHandler = {\n  get(target, key, receiver) {\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return target;\n    }\n    track(target, key);\n    return Reflect.get(target, key, receiver);\n  },\n  set(target, key, value, receiver) {\n    const oldValue = target[key];\n\n    if (oldValue !== value) {\n      const result = Reflect.set(target, key, value, receiver);\n      trigger(target, key, value);\n\n      return result;\n    }\n  },\n};\n\nexport default baseHandler;\n", "export let activeEffect = undefined;\n\nclass ReactiveEffect {\n  public active = true;\n  public parent = undefined;\n  public deps = [];\n  constructor(public fn) {}\n  run() {\n    if (!this.active) {\n      return this.fn();\n    } else {\n      try {\n        this.parent = activeEffect;\n        activeEffect = this;\n        return this.fn();\n      } finally {\n        activeEffect = this.parent;\n        this.parent = null;\n      }\n    }\n  }\n}\nexport function effect(fn) {\n  const _effect = new ReactiveEffect(fn);\n\n  return _effect.run();\n}\n", "import { isObject } from \"@vue/shared\";\nimport baseHandler from \"./baseHandler\";\nimport { activeEffect } from \"./effect\";\n\nconst reactiveMap = new WeakMap();\nconst targetMap = new WeakMap();\n\nexport enum ReactiveFlags {\n  IS_REACTIVE = \"__v_isReactive\",\n}\n\nexport function reactive(obj) {\n  if (!isObject(obj)) {\n    return obj;\n  }\n  if (obj[ReactiveFlags.IS_REACTIVE]) {\n    return obj;\n  }\n  const existing = reactiveMap.get(obj);\n  if (existing) {\n    return existing;\n  }\n\n  const proxy = new Proxy(obj, baseHandler);\n  reactiveMap.set(obj, proxy);\n\n  return proxy;\n}\n\nexport function track(target, key) {\n  if (activeEffect) {\n    let depsMap = targetMap.get(target);\n    if (!depsMap) {\n      targetMap.set(target, (depsMap = new Map()));\n    }\n    let deps = depsMap.get(key);\n    if (!deps) {\n      depsMap.set(key, (deps = new Set()));\n    }\n    const shouldTrack = !deps.has(activeEffect);\n    if (shouldTrack) {\n      deps.add(activeEffect);\n      activeEffect.deps.push(deps);\n    }\n  }\n}\n\nexport function trigger(target, key, value) {\n  const depsMap = targetMap.get(target);\n  if (!depsMap) {\n    return;\n  }\n  const effects = depsMap.get(key);\n  effects?.forEach((effect) => {\n    if (activeEffect !== effect) {\n      effect.run();\n    }\n  });\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAO,oBAAkB,KAAK;AAC5B,WAAO,OAAO,QAAQ,YAAY,QAAQ;AAAA,EAC5C;;;ACCA,MAAM,cAAc;AAAA,IAClB,IAAI,QAAQ,KAAK,UAAU;AACzB,UAAI,QAAQ,oCAA2B;AACrC,eAAO;AAAA,MACT;AACA,YAAM,QAAQ,GAAG;AACjB,aAAO,QAAQ,IAAI,QAAQ,KAAK,QAAQ;AAAA,IAC1C;AAAA,IACA,IAAI,QAAQ,KAAK,OAAO,UAAU;AAChC,YAAM,WAAW,OAAO;AAExB,UAAI,aAAa,OAAO;AACtB,cAAM,SAAS,QAAQ,IAAI,QAAQ,KAAK,OAAO,QAAQ;AACvD,gBAAQ,QAAQ,KAAK,KAAK;AAE1B,eAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAEA,MAAO,sBAAQ;;;ACvBR,MAAI,eAAe;AAE1B,MAAM,iBAAN,MAAqB;AAAA,IAInB,YAAmB,IAAI;AAAJ;AAHnB,WAAO,SAAS;AAChB,WAAO,SAAS;AAChB,WAAO,OAAO,CAAC;AAAA,IACS;AAAA,IACxB,MAAM;AACJ,UAAI,CAAC,KAAK,QAAQ;AAChB,eAAO,KAAK,GAAG;AAAA,MACjB,OAAO;AACL,YAAI;AACF,eAAK,SAAS;AACd,yBAAe;AACf,iBAAO,KAAK,GAAG;AAAA,QACjB,UAAE;AACA,yBAAe,KAAK;AACpB,eAAK,SAAS;AAAA,QAChB;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACO,kBAAgB,IAAI;AACzB,UAAM,UAAU,IAAI,eAAe,EAAE;AAErC,WAAO,QAAQ,IAAI;AAAA,EACrB;;;ACtBA,MAAM,cAAc,oBAAI,QAAQ;AAChC,MAAM,YAAY,oBAAI,QAAQ;AAMvB,oBAAkB,KAAK;AAC5B,QAAI,CAAC,SAAS,GAAG,GAAG;AAClB,aAAO;AAAA,IACT;AACA,QAAI,IAAI,qCAA4B;AAClC,aAAO;AAAA,IACT;AACA,UAAM,WAAW,YAAY,IAAI,GAAG;AACpC,QAAI,UAAU;AACZ,aAAO;AAAA,IACT;AAEA,UAAM,QAAQ,IAAI,MAAM,KAAK,mBAAW;AACxC,gBAAY,IAAI,KAAK,KAAK;AAE1B,WAAO;AAAA,EACT;AAEO,iBAAe,QAAQ,KAAK;AACjC,QAAI,cAAc;AAChB,UAAI,UAAU,UAAU,IAAI,MAAM;AAClC,UAAI,CAAC,SAAS;AACZ,kBAAU,IAAI,QAAS,UAAU,oBAAI,IAAI,CAAE;AAAA,MAC7C;AACA,UAAI,OAAO,QAAQ,IAAI,GAAG;AAC1B,UAAI,CAAC,MAAM;AACT,gBAAQ,IAAI,KAAM,OAAO,oBAAI,IAAI,CAAE;AAAA,MACrC;AACA,YAAM,cAAc,CAAC,KAAK,IAAI,YAAY;AAC1C,UAAI,aAAa;AACf,aAAK,IAAI,YAAY;AACrB,qBAAa,KAAK,KAAK,IAAI;AAAA,MAC7B;AAAA,IACF;AAAA,EACF;AAEO,mBAAiB,QAAQ,KAAK,OAAO;AAC1C,UAAM,UAAU,UAAU,IAAI,MAAM;AACpC,QAAI,CAAC,SAAS;AACZ;AAAA,IACF;AACA,UAAM,UAAU,QAAQ,IAAI,GAAG;AAC/B,uCAAS,QAAQ,CAAC,YAAW;AAC3B,UAAI,iBAAiB,SAAQ;AAC3B,gBAAO,IAAI;AAAA,MACb;AAAA,IACF;AAAA,EACF;",
  "names": []
}
